<div class="login-page flex-center">
  <div class="login-container card">
    @if (isSignUpMode()) {
      <div class="back-button">
        <button type="button" class="link" (click)="switchToLoginMode()">
          <span>←</span> Indietro
        </button>
      </div>
    }
    <div class="logo">
      <div class="logo-icon"></div>
      <div class="logo-text">Component Hub</div>
    </div>
    
    <!-- Modalità Login -->
    @if (!isSignUpMode()) {
      <h1 class="login-title">Accedi</h1>
      <p class="welcome-text">Benvenuto!<br> Inserisci le tue credenziali per continuare.</p>
      
      @if (authError(); as error) {
        <div class="message message-error">{{ error }}</div>
      }
      @if (successMessage(); as success) {
        <div class="message message-success">{{ success }}</div>
      }
      
      <form [formGroup]="loginForm" (ngSubmit)="onLogin()" class="login-form">
        <div class="form-group">
          <input 
            id="email" 
            type="email" 
            formControlName="email" 
            placeholder="Email" 
            class="input-field"
          >
        </div>
        
        <div class="form-group">
          <div class="password-field-wrapper">
            <input 
              id="password" 
              [type]="showPassword() ? 'text' : 'password'" 
              formControlName="password" 
              placeholder="Password" 
              class="input-field"
            >
            <button 
              type="button" 
              class="password-toggle" 
              (click)="togglePasswordVisibility()"
              [attr.aria-label]="showPassword() ? 'Nascondi password' : 'Mostra password'"
            >
              <span class="eye-icon" [class.hidden]="showPassword()"></span>
            </button>
          </div>
        </div>
        
        <div class="checkbox-container flex-between">
          <div class="checkbox-group">
            <input type="checkbox" id="remember-me" class="checkbox" formControlName="rememberMe">
            <label for="remember-me">Ricordami</label>
          </div>
          <a href="#" class="link" (click)="$event.preventDefault(); onSendResetLink()">
            Hai dimenticato la password?
          </a>
        </div>
        
        @if (authService.state.isLoading()) {
          <button type="button" class="btn btn-primary btn-full btn-lg" disabled>
            Caricamento...
          </button>
        } @else {
          <button type="submit" class="btn btn-primary btn-full btn-lg" [disabled]="loginForm.invalid">
            Accedi
          </button>
        }
        
        <p class="signup-text text-center">
          Non hai un account? 
          <button type="button" class="link" (click)="switchToSignUpMode()">
            Registrati ora
          </button>
        </p>
      </form>
    }
    
    <!-- Modalità Registrazione -->
    @if (isSignUpMode()) {      
      <h1 class="login-title">Registrati</h1>
      <p class="welcome-text">Crea il tuo account per iniziare ad utilizzare Component Hub.</p>
      
      @if (authError(); as error) {
        <div class="message message-error">{{ error }}</div>
      }
      @if (successMessage(); as success) {
        <div class="message message-success">{{ success }}</div>
      }
      
      <form [formGroup]="loginForm" (ngSubmit)="onSignUp()" class="login-form">
        <div class="form-group">
          <input 
            id="signup-email" 
            type="email" 
            formControlName="email" 
            placeholder="Email" 
            class="input-field"
          >
        </div>
        
        <div class="form-group">
          <div class="password-field-wrapper">
            <input 
              id="signup-password" 
              [type]="showPassword() ? 'text' : 'password'" 
              formControlName="password" 
              placeholder="Password (minimo 6 caratteri)" 
              class="input-field"
            >
            <button 
              type="button" 
              class="password-toggle" 
              (click)="togglePasswordVisibility()"
              [attr.aria-label]="showPassword() ? 'Nascondi password' : 'Mostra password'"
            >
              <span class="eye-icon" [class.hidden]="showPassword()"></span>
            </button>
          </div>
        </div>
        
        @if (authService.state.isLoading()) {
          <button type="button" class="btn btn-primary btn-full btn-lg" disabled>
            Registrazione in corso...
          </button>
        } @else {
          <button type="submit" class="btn btn-primary btn-full btn-lg" [disabled]="loginForm.invalid">
            Registrati
          </button>
        }
      </form>
    }
  </div>
</div>