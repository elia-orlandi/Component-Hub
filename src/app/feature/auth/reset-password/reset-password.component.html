<div class="login-page flex-center">
  <div class="login-container card">
    <div class="logo">
      <div class="logo-icon"></div>
      <div class="logo-text">Component Hub</div>
    </div>
    
    @if (!successMessage()) {
      <h1 class="login-title">Imposta una nuova password</h1>
      <p class="welcome-text">Inserisci la tua nuova password per completare il reset.</p>
      
      @if (formError(); as error) {
        <div class="message message-error">{{ error }}</div>
      }
      
      <form [formGroup]="resetForm" (ngSubmit)="onResetPassword()" class="login-form">
        <div class="form-group">
          <div class="password-field-wrapper">
            <input 
              id="password" 
              [type]="showPassword() ? 'text' : 'password'" 
              formControlName="password" 
              placeholder="Nuova Password (minimo 6 caratteri)" 
              class="input-field"
            >
            <button 
              type="button" 
              class="password-toggle" 
              (click)="togglePasswordVisibility()"
              [attr.aria-label]="showPassword() ? 'Nascondi password' : 'Mostra password'"
            >
              <span class="eye-icon" [class.hidden]="showPassword()"></span>
            </button>
          </div>
        </div>
        
        <div class="form-group">
          <div class="password-field-wrapper">
            <input 
              id="confirmPassword" 
              [type]="showConfirmPassword() ? 'text' : 'password'" 
              formControlName="confirmPassword" 
              placeholder="Conferma Nuova Password" 
              class="input-field"
            >
            <button 
              type="button" 
              class="password-toggle" 
              (click)="toggleConfirmPasswordVisibility()"
              [attr.aria-label]="showConfirmPassword() ? 'Nascondi password' : 'Mostra password'"
            >
              <span class="eye-icon" [class.hidden]="showConfirmPassword()"></span>
            </button>
          </div>
          @if (resetForm.hasError('passwordMismatch')) {
            <div class="validation-error">Le password non corrispondono.</div>
          }
        </div>
        
        @if (authService.state.isLoading()) {
          <button type="button" class="btn btn-primary btn-full btn-lg" disabled>
            Salvataggio...
          </button>
        } @else {
          <button type="submit" class="btn btn-primary btn-full btn-lg" [disabled]="resetForm.invalid">
            Salva Nuova Password
          </button>
        }
      </form>
    } @else {
      <div class="success-container text-center">
        <h1 class="login-title">Password Aggiornata!</h1>
        <div class="message message-success">{{ successMessage() }}</div>
        <a routerLink="/auth/login" class="btn btn-secondary">Torna al Login</a>
      </div>
    }
  </div>
</div>